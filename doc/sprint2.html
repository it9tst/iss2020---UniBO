<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>LABORATORIO DI SISTEMI SOFTWARE 2020 - Sprint 1</title>
        <!-- Bootstrap -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" crossorigin="anonymous">
        <style type="text/css">
            em{
                font-size: 80%;
                font-weight: bold;
                border-style:solid;
                border-color: #e9ecef;
                color: #28a745;
            }
            .qak {
                height:500px;
                overflow-y: visible;
            }
        </style>
    </head>
    <body>
		<div class="jumbotron jumbotron-fluid text-center" style="padding: 5px">
			<h1 class="display-4">LABORATORIO DI SISTEMI SOFTWARE 2020</h1>
			<p class="lead">Sprint 2</p>
		</div>
		<div class="container">
			<div class="row text-center">
				<div class="col-lg-6 offset-lg-3">
				   <h2><u>Requisiti</u></h2>
                    <hr class="my-4">
                </div>
			</div>
            <div>
            
            <h4>Tea-room COVID-19</h4> 

            The <em>manager</em> of a <em>tearoom</em> intends to regulate the access to the service by means of a ddr robot (<em>waiter</em>).
            <br/><br/>
            The <em>tearoom</em> is a rectangular room that includes:

            <ul>
            <li>an <em>entrancedoor</em> to enter in the room and an <em>exitdoor</em> to exit form it;</li>
            <li>a number <tt>N (N=2)</tt> of <em>teatable</em>;</li>
            <li>a <em>serviceare</em> including a <em>servicedesk</em> at which works a <em>barman</em>;</li>
            <li>a <em>hall</em> equipped with a <em>presencedetector</em>, i.e. a device (e.g. a sonar) that can detect the presence of 
            a person (or some other entity) in it.</li>
            </ul>

            The <em>waiter</em> can freely move along the borders of the tearoom, since there are no obstacles there. 

            <center><img src="https://raw.githubusercontent.com/it9tst/iss2020ProjectBO/feature/sprint2_an_req/doc/assets/tearoom20.png" alt="tearoom20.png" width="65%"/></center>


            <h5>User stories</h5>
            As a <em>client</em>:
            <ul>
            <li>I intend to <em>notify</em> my interest in <em>entering</em> in a <em>safe tearoom</em>, <em>sitting</em> at a free teatable,  <em>ordering</em> 
            some tea,  <em>consuming</em> it  (within a limited amount of time <em>maxstaytime</em>)  <em>paying</em> the service
            with my credit card and finally <em>leaving</em> the room.</li>
            <li>For <em>safe tearoom</em>, I intend a tearoom with clean tea-tables posed at a proper distance; the room is populated by human clients 
            whose body temperature is less than <tt>37.5</tt> degrees. </li>
            <li>I can submit my notification of interest by hitting the <em>smartbell</em> located near the  <em>entrancedoor</em> 
            that will automatically measure my body temperature and send a request message to the <em>waiter</em>, by giving to me an unique <em>clientidentifier</em>.
            </li>
            <li>If my body temperature is ok, but my request cannot be immediately satisfied (since the room is full), I will be <em>informed</em> by the <em>waiter</em> 
            about the maximum waiting time.</li>
            </ul>

            As a <em>manager</em>:
            <ul>
            <li>I intend to be able to see the <em>current state</em> of the <em>tearoom</em> by using  a browser connected to a web-server 
            associated to the application.
            </li>
            </ul>


            <h5>Requirements</h5>

            The <em>waiter</em> should perform the following tasks:
            <ul>

            <li><em>accept</em> the request of a client to enter in the tearoom if there is at least one teatable in the state <em>tableclean</em>, i.e.
            the table is free and has been properly cleaned; </li>
            <li><em>inform</em> the client about the maximum waiting time if there is no <em>tableclean</em>;</li> 
            <li><em>reach</em> the <em>entrance door</em> and <em>convoy</em> the accepted client to the selected teatable;</li>
            <li><em>take</em> the order of the client and transmit it (using a wifi-device) to the <em>barman</em>; </li>
            <li><em>serve</em>  the client when the <em>barman</em> says that the requested drink is ready;</li>
            <li><em>collect</em> the payment from the client when he/she has finished to consume or when the <em>maxstaytime</em> is expired;</li>
            <li><em>convoy</em> the client to the <em>exitdoor</em>;</li>
            <li><em>clean</em> the tea-table just freed  by the client;</li>
            <li><em>rest</em> at my <em>home</em> when there is nothing to do.</li>
            </ul>

            Since the room could contain <tt>N</tt> clients at the time, the <em>waiter</em> should reduce as much as possible the waiting time of the requests coming from each client.<br><br>
            
            </div>
			<br>
			<hr>
			<br>
			<div class="row text-center">
				<div class="col-lg-6 offset-lg-3"><u><h2>Analisi dei requisiti</h2></u></div>
                <hr class="my-4">
			</div>
			<div>
				<p>Partendo dall'analisi dei problemi dello sprint precedente, procediamo con uno scenario in cui si richiedano delle interruzioni e cominciamo a modellarlo.</p>
				<table class="table table-striped table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">Caso d'uso</th>
                            <th scope="col">Descrizione</th>
                        </tr>
                    </thead>
                    <tbody>
						<tr>
                            <th scope="row">Cliente</th>
                            <td>Virtuale</td>
                        </tr>
                        <tr>
                            <th scope="row">Clienti idonei</th>
                            <td>N</td>
                        </tr>
						<tr>
                            <th scope="row">Clienti non idonei</th>
                            <td>NAN</td>
                        </tr>
                        <tr>
                            <th scope="row">Tavoli liberi</th>
                            <td>2</td>
                        </tr>
						<tr>
                            <th scope="row">Tavoli sanificati</th>
                            <td>2</td>
                        </tr>
						<tr>
                            <th scope="row">Step 1</th>
                            <td>Il waiter fa accomodare un cliente al tavolo libero e sanificato, prende l'ordinazione, la comunica al barman che la prepara,<br> e una volta pronta la serve al cliente.<br> Nel frattempo arriva un altro cliente che segue esattamente lo stesso iter dell'altro.
						  </td>
                        </tr>
						<tr>
                            <th scope="row">Step 2</th>
                            <td>Uno dei clienti termina di consumare e il waiter dopo averlo fatto pagare, lo accompagna all'uscita e si avvicina al tavolo liberato per sanificarlo.<br> Quando il waiter si trova al secondo step di pulizia, il cliente dell'altro tavolo occupato vuole effettuare un'altra ordinazione.<br> Il waiter quindi interrompe la sua attività e va dal cliente a prendere l'ordine, lo comunica al barman e prima di ritornare alla home controlla se ci sono tavoli da sanificare.<br> A questo punto torna al tavolo che stava pulendo, termina la sua attività e ritorna alla home.
							</td>
                        </tr>
                    </tbody>
                </table>
				<p>Definiamo i task che saranno interrompibili a runtime.</p>
				<table class="table table-striped table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">Task prioritari</th>
							<th scope="col">Conviene interrompere?</th>
							<th scope="col">Task che interrompono</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">Clean</th>
							<td>Si</td>
							<td>Tutti</td>
                        </tr>
                        <tr>
                            <th scope="row">Rest</th>
							<td>Si</td>
							<td>Tutti</td>
                        </tr>
                    </tbody>
                </table>
				<p>Per quanto riguarda l'interrompibilità del task clean, il waiter riprenderà l'attività di pulizia dalla fase in cui era stata interrotta.
					<br>
					Al termine di un task, il waiter controllerà che non ci siano ulteriori richieste da parte dei clienti in attesa o che non siano presenti tavoli da pulire. In tal caso il waiter tornerà nella home.
					<br>
					A tale scopo, introduciamo 5 nuovi messaggi che distinguono e definiscono le varie fasi della pulizia dei tavoli.</p>
				<table class="table table-striped table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col">Messaggio</th>
							<th scope="col">Tipologia</th>
                            <th scope="col">Descrizione</th>
                            <th scope="col">Entità</th>
                            <th scope="col">Parametri</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">goToClearing</th>
							<td>Dispatch</td>
                            <td>Il WaiterMind passa allo stato tableCleared.</td>
                            <td>waitermind</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <th scope="row">goToCleaning</th>
							<td>Dispatch</td>
                            <td>Il WaiterMind passa allo stato tableCleaned.</td>
                            <td>waitermind</td>
                            <td>-</td>
                        </tr>
						<tr>
                            <th scope="row">goToSanitizing</th>
							<td>Dispatch</td>
                            <td>Il WaiterMind passa allo stato tableSanitized.</td>
                            <td>waitermind</td>
                            <td>-</td>
                        </tr>
						<tr>
                            <th scope="row">clean</th>
							<td>Request</td>
                            <td>Il WaiterMind comunica al WaiterEngine di iniziare uno dei tre stati di pulizia.</td>
                            <td>waiterengine - waitermind</td>
                            <td>STATE</td>
                        </tr>
						<tr>
                            <th scope="row">cleanDone</th>
							<td>Reply</td>
                            <td>Il WaiterEngine comunica al WaiterMind di aver completato uno dei tre stati di pulizia.</td>
                            <td>waiterengine - waitermind</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
				<p>Inoltre, il committente ha chiarito come dovrebbe avvenire la gestione del "maxstaytime" del cliente, ovvero il tempo che il cliente ha a disposizione per effettuare la sua consumazione nella tearoom: la misurazione avviene solo quando è responsabilità del cliente "perdere" tempo. Dopo che il waiter ha accompagnato il cliente al tavolo, si fa partire il timer. Dopo aver effettuato l'ordine, il timer viene stoppato in quanto il tempo che passa non è più "colpa" del cliente ma del barman. Quindi il timer viene riavviato nel momento in cui il cliente consuma l'ordinazione.</p>
				<p>Ecco il grafo aggiornato degli stati che compongono il WaiterMind.</p>
                <a href="javascript:void(0)" class="pop">
                    <center><img src="https://raw.githubusercontent.com/it9tst/iss2020ProjectBO/feature/sprint2_an_req/doc/assets/statiWaiterMind.png" alt="statiWaiterEngine.png" style="width: 40%;"/></center>
                </a>
				<br>
				<br>
				<p>Ecco il grafo aggiornato degli stati che compongono il WaiterEngine.</p>
                <a href="javascript:void(0)" class="pop">
                    <center><img src="https://raw.githubusercontent.com/it9tst/iss2020ProjectBO/feature/sprint2_an_req/doc/assets/statiWaiterEngine.png" alt="statiWaiterEngine.png" style="width: 40%;"/></center>
                </a>
            </div>
			<br>
			<hr>
			<br>
			<div class="row text-center">
				<div class="col-lg-6 offset-lg-3"><u><h2>Test plan</h2></u></div>
				<hr class="my-4">
			</div>
            <div>
				<p>Il test è visionabile a questo link: <a href="https://github.com/it9tst/iss2020ProjectBO/blob/feature/sprint2_an_req/ct.tearoom/test/test_01.kt">TEST_01</a></p>
				<p>Si assume che i clienti siano virtuali.</p>
				<ul>
				<li>Il cliente numero 1 arriva alla tearoom con temperatura minore di 37.5 gradi e suona il campanello. Dopo che lo smartbell gli ha misurato la temperatura, viene accettato e comunicato al waiter. Dopo aver controllato che vi è almeno un tavolo pulito e libero, fa accomodare il cliente. Il cliente ordina, il waiter comunica al barman l'ordinazione, il barman la prepara e comunica al waiter quando è pronta, il waiter la prende per servirla al cliente e torna nella home.</li>
				<li>Il cliente numero 2 arriva alla tearoom con temperatura minore di 37.5 gradi e suona il campanello. Dopo che lo smartbell gli ha misurato la temperatura, viene accettato e comunicato al waiter. Dopo aver controllato che vi è almeno un tavolo pulito e libero, fa accomodare il cliente. Il cliente ordina, il waiter comunica al barman l'ordinazione, il barman la prepara e comunica al waiter quando è pronta, il waiter la prende per servirla al cliente e torna nella home.</li>
				<li>Il cliente numero 1, una volta finito di consumare, paga il waiter che lo accompagna all'uscita dalla tearoom. Quindi il waiter, dopo aver controllato se ci sono tavoli sporchi da pulire o finire di pulire, comincia a pulire in fasi il tavolo sporco.
				<li>A questo punto il waiter viene interrotto dal cliente numero 2 che decide di ordinare di nuovo. Quindi il waiter comunica al barman l'ordinazione, e mentre aspetta che il barman la prepara, controlla se ci sono tavoli da pulire o finire di pulire e finisce il lavoro dallo stato intermedio.</li>
				</ul>
			</div>
			<br>
			<br>
		</div>
        <div class="container-fluid" style="background-color: #e9ecef; padding: 15px 0px">
            <div class="container">
                <div class="card-group" style="margin: 0 auto; width: 600px;">
                    <div class="card">
                        <img src="https://raw.githubusercontent.com/it9tst/iss2020ProjectBO/feature/sprint2_an_req/doc/assets/vc.jpg" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">Vittorio Corsale</h5>
                            <p class="card-text">vittorio.corsale@studio.unibo.it</p>
                        </div>
                    </div>
                    <div class="card">
                        <img src="https://raw.githubusercontent.com/it9tst/iss2020ProjectBO/feature/sprint2_an_req/doc/assets/gt.jpg" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">Gabriele Tornatore</h5>
                            <p class="card-text">gabriele.tornatore@studio.unibo.it</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
        <script>
            $(function() {
                $('.pop').on('click', function() {
                    $('.imagepreview').attr('src', $(this).find('img').attr('src'));
                    $('#imagemodal').modal('show');   
                });   
            });
        </script>
    </body>
</html>